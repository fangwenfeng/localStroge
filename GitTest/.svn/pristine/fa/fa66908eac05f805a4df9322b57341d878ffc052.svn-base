<!DOCTYPE HTML>
<html>
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="maximum-scale=1.0, minimum-scale=1.0, user-scalable=0, initial-scale=1.0, width=device-width"/>
    <meta name="format-detection" content="telephone=no, email=no, date=no, address=no">
    <title>Hello APP</title>
    <link rel="stylesheet" type="text/css" href="../css/api.css" />
    <style>
      html,body{
        height: 100%;
    }
    #wrap{
        height: 100%;
        display: -webkit-box;
        display: -webkit-flex;
        display: flex;
        -webkit-box-orient: vertical;
        -webkit-flex-flow: column;
        flex-flow: column;
    }
    #header{
        text-align: center; background-color: #81a9c3; color: #fff;
        width: 100%;height: 30px;
    }

    #main{
        -webkit-box-flex: 1; 
        -webkit-flex: 1;
        flex: 1;
    }
    #footer{
        height: 30px; line-height: 30px;
        background-color: #81a9c3; 
        width: 100%;
        text-align: center;
        position: absolute;
        bottom: 0;
    }
    #footer h5{
        color: white;
    }
    .divCss{
        height: 50px;
        line-height: 50px;
        color: #000;
        font-size:16px;
        text-align: center;
        border-bottom: 1px solid #444;
    }
    span {
        margin: 3px 5px;
        display: inline-block;
    }
</style>
</head>
<body>           
    <div class="divCss">
        <span tapmode onclick="UIScrollPictureOpen()">图片轮播</span>
        <span tapmode onclick="UIScrollPictureClose()">关闭</span>
    </div>   
    <div class="divCss">
        <span tapmode onclick="UIMediaScannerOpen()">本地媒体资源扫描</span>
        <span tapmode onclick="UIMediaScannerScan()">扫描</span>
    </div> 
    <div class="divCss">
        <span tapmode onclick="personalCenteOpen()">个人信息展示</span>
        <span tapmode onclick="personalCenteClose()">关闭</span>
    </div>    
    <div class="divCss">
        <span tapmode onclick="UISearchBarOpen()">搜索框</span>
    </div>
    <div class="divCss">
        <span tapmode onclick="UIScrollPromptViewOpen()">可提示的轮播</span>
        <span tapmode onclick="UIScrollPromptViewClose()">关闭</span>
    </div>  
    <div class="divCss">
        <span tapmode="hover" onclick="UILoadingFlower()">旋转菊花”型加载提示框</span>
         <span tapmode="hover" onclick="UILoadingCloseFlower()">closeFlower</span>
        <span tapmode="hover" onclick="UILoadingKeyFrame()">keyFrame</span>
        <span tapmode="hover" onclick="UILoadingCloseKeyFrame()">closeKeyFrame</span>
    </div>    
</body>
<script type="text/javascript" src="../script/api.js"></script>
<script type="text/javascript">
    var UIScrollPicture;
    var UIMediaScanner;
    var personalCenter;
    var UISearchBar;
    var UIScrollPromptView;
    var UILoading;
    var UILoadingFlowerId;
    var UILoadingKeyFrameId;
    apiready = function() {
        UIScrollPicture = api.require('UIScrollPicture');
        UIMediaScanner = api.require('UIMediaScanner');
        personalCenter = api.require('personalCenter');
        UISearchBar = api.require('UISearchBar');
        UIScrollPromptView = api.require('UIScrollPromptView');
        UILoading = api.require('UILoading');
        api.setCustomRefreshHeaderInfo({
            bgColor : '#f0f0f0',
            image : {
                pull : 'widget://image/pull.png',
                transform : [
                    'widget://image/pull_end_image_frame_01.png',
                    'widget://image/pull_end_image_frame_02.png',
                    'widget://image/pull_end_image_frame_03.png',
                    'widget://image/pull_end_image_frame_04.png',
                    'widget://image/pull_end_image_frame_05.png'
                ],
                load : [
                    'widget://image/refreshing_image_frame_01.png',
                    'widget://image/refreshing_image_frame_02.png',
                    'widget://image/refreshing_image_frame_03.png',
                    'widget://image/refreshing_image_frame_04.png',
                    'widget://image/refreshing_image_frame_05.png',
                    'widget://image/refreshing_image_frame_06.png'
                ]
            }
        }, function() {
            setTimeout(function(){
                api.refreshHeaderLoadDone()
            }, 3000);
        });
    };
    function UILoadingFlower(){
        UILoading.flower({
            center: {                            
                x: 160,            
                y: 300         
            },
            size: 30,
            fixed: true
        }, function(ret){   
            UILoadingFlowerId = ret.id;
        });
    }
    function UILoadingKeyFrame(){
        UILoading.keyFrame({
            rect: {
                w: 80,                              
                h: 100      
            },
            styles: {
                bg: 'rgba(0,0,0,0.5)', 
                corner: 5, 
                interval: 50,
                frame:{ 
                    w: 80, 
                    h: 80
                }
            },
            content: [{
                 frame: 'widget://image/refreshing_image_frame_01.png' 
            },{
                 frame: 'widget://image/refreshing_image_frame_02.png' 
            },{
                 frame: 'widget://image/refreshing_image_frame_03.png' 
            },{
                 frame: 'widget://image/refreshing_image_frame_04.png' 
            },{
                 frame: 'widget://image/refreshing_image_frame_05.png' 
            },{
                 frame: 'widget://image/refreshing_image_frame_06.png' 
            }]
        }, function(ret){   
            alert(JSON.stringify(ret));
        });
    }
    function UILoadingCloseFlower(){
        UILoading.closeFlower ({
            id: UILoadingFlowerId
        });
    }
    function UILoadingCloseKeyFrame(){
        UILoading.closeKeyFrame();
    }
    
    function UIScrollPromptViewOpen(){
        UIScrollPromptView.open({
            rect: {
                x: 0,
                y: api.winHeight / 2.5 ,
                w: api.winWidth,
                h: 200
            },
            data: {
                paths: [
                    'widget://image/cat.jpg', 
                    'widget://image/gogd.jpg', 
                    'widget://image/row.jpg'
                ],
                captions: ['apicloud', 'apicloud', 'apicloud', 'apicloud'],
                prompts: [
                    'widget://image/cat.jpg', 
                    'widget://image/gogd.jpg', 
                    'widget://image/row.jpg'
                ]
            },
            styles: {
                caption: {
                    height: 35,
                    color: '#E0FFFF',
                    size: 13,
                    bgColor: '#696969',
                    position: 'bottom'
                },
                indicator: {
                    align: 'center',
                    color: '#FFFFFF',
                    activeColor: '#DA70D6'
                },
                prompt: {
                   button: {
                      normal: 'widget://image/spink.png',
                      highlight: 'widget://image/sgreen.png',
                      x: 0,
                      y: 100,
                      w: 60,
                      h: 40
                   },
                   x: 0,
                   y: 50,
                   w: 160,
                   h: 90,
                   contentMode: 'scaleToFill',
                   animation: true
                }
            },
            placeholderImg: 'widget://image/blue.png',
            contentMode: 'scaleToFill',
            interval: 3,
            fixedOn: api.frameName,
            auto:true,
            loop: true,
            fixed: false
        },function( ret ){
            if( ret ){
                 alert( JSON.stringify( ret ) );
            }
        });
    }
    function UIScrollPromptViewClose(){
        UIScrollPromptView.close();
    }
    function UISearchBarOpen(){
        UISearchBar.open({
            placeholder: '请输入搜索关键字',
            historyCount: 10,
            showRecordBtn: true,
            texts: {
                cancelText: '取消',
                clearText: '清除搜索记录'
            },
            styles: {
                navBar: {
                    bgColor: '#FFFFFF',
                    borderColor: '#ccc'
                },
                searchBox: {
                    bgImg: '',
                    color: '#000',
                    height: 44
                },
                cancel: {
                    bg: 'rgba(0,0,0,0)',
                    color: '#D2691E',
                    size: 16
                },
                list: {
                    color: '#696969',
                    bgColor: '#FFFFFF',
                    borderColor: '#eee',
                    size: 16
                },
                clear: {
                    color: '#000000',
                    borderColor: '#ccc',
                    size: 16
                }
            }
        }, function(ret, err){
            if( ret ){
                 alert( JSON.stringify( ret ) );
            }else{
                 alert( JSON.stringify( err ) );
            } 
        });
    }
    var btnArray = [{
            'bgImg': 'widget://image/sblue.png',
            'selectedImg': 'widget://image/sgreen.png',
            'lightImg': 'widget://image/spink.png',
            'title': '好友',
            'count': '5'
        },{
            'bgImg': 'widget://image/sblue.png',
            'selectedImg': 'widget://image/sgreen.png',
            'lightImg': 'widget://image/spink.png',
            'title': '回贴',
            'count': '240'
        },{
            'bgImg': 'widget://image/sblue.png',
            'selectedImg': 'widget://image/sgreen.png',
            'lightImg': 'widget://image/spink.png',
            'title': '主题',
            'count': '27'
        }];
    var count = 382;
    var y = 200;
    function personalCenteOpen(){
        personalCenter.open({
            'y': y,
            'imgPath': 'widget://image/girl1.jpg',
            'imgPath': 'widget://image/girl1.jpg',
            'userName': 'APICloud',
            'count': count,
            'modButton': {
                'bgImg': 'widget://image/fangduigou.png',
                'lightImg': 'widget://image/duigou.png'
            },
            fixedOn: api.frameName,
            'btnArray': btnArray
        },function(ret,err){
            /* 头像修改按钮. */
            if(btnArray.length === ret.click){
                api.confirm({
                    title: '聊天盒子',
                    msg: '您想要从哪里选取图片 ?',
                    buttons:['优雅自拍', '相册收藏', '取消']
                },function(ret,err){
                    var sourceType = 'album';
                    if(3 == ret.buttonIndex){ // 取消
                        return;
                    }
                    if(1 == ret.buttonIndex){ // 打开相机
                        sourceType = 'camera';
                    }
                    api.getPicture({
                        sourceType: sourceType,
                        encodingType: 'png',
                        mediaValue: 'pic'
                    }, function(ret, err){
                        if (ret) {
                            personalCenter.updateValue({
                                imgPath: ret.data,
                                count:count
                            });

                        }
                    });

                });
                return;
            }
            var msg;
            /* 修改按钮. */
            if(btnArray.length + 1 == ret.click){
                msg = '您没有修改权限!';
            }
            if(btnArray.length + 2 == ret.click){
                msg = '您没有设置权限!'
            }
            if(btnArray.length == ret.click){
                btn = btnArray[ret.click];
                msg = btn.title + ' 数量为 ' + btn.count
            }
            api.toast({
                msg: msg,
                duration: 1000,
                location: 'bottom'
            });
        });
    }
    function personalCenteClose(){
        personalCenter.close();
    }
    function UIMediaScannerOpen() {
        UIMediaScanner.open({
            type: 'picture',
            column: 4,
            classify: true,
            max: 2,
            sort: {
                key: 'time',
                order: 'desc'
            },
            texts: {
                stateText: '已选择*项',
                cancelText: '取消',
                finishText: '完成'
            },
            styles: {
                bg: '#fff',
                mark: {
                    icon: '',
                    position: 'bottom_left',
                    size: 20
                },
                nav: {
                    bg: '#eee',
                    stateColor: '#000',
                    stateSize: 18,
                    cancelBg: 'rgba(0,0,0,0)',
                    cancelColor: '#000',
                    cancelSize: 18,
                    finishBg: 'rgba(0,0,0,0)',
                    finishColor: '#000',
                    finishSize: 18
                }
            },
            scrollToBottom:{
               intervalTime: 3,
               anim: true
            },
            exchange: true,
            rotation: true
        }, function( ret ){
            if( ret ){
                alert( JSON.stringify( ret ) );
            }
        });
    }
    function UIMediaScannerScan() {
        UIMediaScanner.scan({
            type: 'all',
            count: 10,
            sort: {
                key: 'time',
                order: 'desc'
            },
            thumbnail: {  //返回的缩略图配置
                w: 100, 
                h: 100
            }
        }, function( ret ){
            if( ret ){
                alert( JSON.stringify( ret ) );
            }
        });
    }
        
    function UIScrollPictureOpen() {
        UIScrollPicture.open({
            rect : {
                x : 0,
                y : 50,
                h : 200
            },
            data : {
                paths : [
                'widget://image/cat.jpg', 
                'widget://image/catd.jpg', 
                'widget://image/gogd.jpg'
                ],
                captions : ['猫', '猫2', '狗'] //说明文字数组
            },
            styles : {
                caption : {
                    height : 35,
                    color : '#E0FFFF',
                    size : 13,
                    bgColor : '#696969',
                    position : 'bottom',
                    alignment: 'center'
                },
                indicator : {  //指示器样式
                    align : 'center',
                    color : '#FFFFFF',
                    activeColor : '#DA70D6',
                }
            },
            placeholderImg : 'widget://image/green.png',
            contentMode : 'scaleToFill',  //图片填充模式
            interval : 3,
            loop : true,
            auto:true,
            fixedOn: api.frameName,
            fixed : false
        }, function(ret, err) {
            if (ret) {
                alert(JSON.stringify(ret));
            } else {
                alert(JSON.stringify(err));
            }
        });
    };
    function UIScrollPictureClose() {
        UIScrollPicture.close();
    };
        
</script>
</html>